<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title>Login</title>
    <link rel="stylesheet" href="style.css" />
</head>
<body>
   
    <!--On fabrique ici les boutons qui vont permettre l'utilisateur de se connecter-->
  <form method="POST">
    <div class="card2">
        <label for="uname"><p>Pseudo:</p></label>
  <input type="text" placeholder="Entrer le pseudo" id= "uname" name="uname" required>
  <label for="psw"><p>Mot de passe:</p></label>
  <input type="password" placeholder="Entrer le mot de passe" id="psw" name="psw" required>
  <button type="submit" onclick="Login()">Se connecter</button>
    </div>
  </form>
  <script>
    var a = new Array();
    up1 = new Object();
    up2 = new Object();
    up3 = new Object();

// On crée deux utilisateurs factices pour pouvoir ultérieurement les utiliser pour le partage de la partition
up1={
 name:"Françis",
 password:btoa('mdpdeFrançis') // btoa crypte le mot de passe, atob le décrypte
};

up2={
 name:"Giselle",
 password:btoa("mdpdeGiselle")
};

up3={
 name:"Valentin",
 password:btoa("  ")
};

a.push(up1);
a.push(up2);
a.push(up3);

    function Login()
{

var username = document.getElementById("uname").value;
var password = document.getElementById("psw").value;
var dude = new Object();

//on stocke les variables (tous les utilisateurs et l'utilisateur actuel)
localStorage.setItem('all_users',JSON.stringify(a));
a=JSON.parse((localStorage.getItem("all_users")));

if(a.some(dude => dude.name === username, dude.password === btoa(password))){
  window.open("index.html");
}
else {
  alert("les identifiants ne sont pas bons");
}




/*a.push({name: username, password: btoa(password)});
localStorage.setItem('name',JSON.stringify({name: username, password: btoa(password)}));
localStorage.setItem('all_users',JSON.stringify(a)); */

//Pour notre cas, tant que le serveur n'est pas en place, on veut rentrer "Valentin" en pseudo et "mdpdeValentin" en mdp
//Le string dans le localStorage sera: [{"name":"Françis","password":"bWRwZGVGcmFu52lz"},{"name":"Giselle","password":"bWRwZGVHaXNlbGxl"},{"name":"Valentin","password":"bWRwZGVWYWxlbnRpbg=="}]
}
  </script>
  </body>
  </html>